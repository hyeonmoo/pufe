<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.putupiron.pufe">
	<!-- 로그인 -->
	<select id="selectUser" parameterType="String" resultType="User">
		select * from user where user_email=#{user_email}
	</select>
	<!-- 회원가입 -->
	<insert id="join" parameterType="JoinData">
		insert into user values(#{user_email},#{user_pw},#{user_name},#{gender},#{user_tel},"U",null,null,0,0,0)
	</insert>
	<!-- 이메일찾기 -->
	<select id="findEmail" parameterType="map" resultType="String">
		select user_email from user where <if test='type=="R"'>user_email=#{email} and</if> user_name=#{name} and user_tel=#{phone}
	</select>
	<!-- 비밀번호 재설정 -->
	<update id="resetPw" parameterType="map">
		update user set user_pw=#{user_pw} where user_email=#{user_email}
	</update>
	<!-- Big3 랭킹집계 -->
	<select id="bigThreeRank" resultType="BigThree">
		select rank() over (order by squat+benchpress+deadlift desc) as ranking, user_email, user_name,
		squat+benchpress+deadlift as big3, squat, benchpress, deadlift
		from user
		order by big3 desc, user_name desc
	</select>
	<!-- 유저 Big3 랭킹정보 -->
	<select id="userBig3Rank" parameterType="String" resultType="int">
		select ranking from rankingView where user_email=#{email};
	</select>
</mapper>